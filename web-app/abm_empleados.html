<!DOCTYPE html>
<html>
<head>
	<title>ABM Empleados</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
	<script type="text/javascript" src="js/jquery-2.1.3.js"></script>
	<link rel="icon" type="image/png" href="http://developers.mercadolibre.com/wp-content/uploads/logo_puzzle_slider.png"/>
</head>
<body class="container" style="width: 60%;">
	<table class="table">
		<thead>
			<tr>
				<th>Nombre</th><th>Apellido</th><th>Cumplea&ntilde;os</th>
			</tr>
		</thead>
		<tbody id="listaEmpleados">
		</tbody>
	</table>
	<form id="formCreate" style="width: 60%; margin: 0 auto">
		<div class="form-group">
			<label>Nombre</label>
			<input class="form-control" type="text" pattern="[A-Za-z]+" placeholder="Inrese el nombre" name="nombre" id="nombreEmpleado"/>
		</div>
		<div class="form-group">
			<label>Apellido</label>
			<input class="form-control" type="text" pattern="[A-Za-z]+" placeholder="Ingrese el apellido" name="apellido" id="apellidoEmpleado"/>
		</div>
		<div class="form-group">
			<label>Nacimiento</label>
			<input class="form-control" type="text" placeholder="Ingrese la fecha aaaa/mm/dd" name="nacimiento" id="fechaEmpleado"/>
		</div>
		<div style="text-align: right">
			<button type="button" class="btn btn-success" id="botonCrear">Crear empleado</button>
			<button type="button" class="btn btn-danger" id="botonCancelar">Cancelar</button>
		</div>
	</form>

	<script type="text/template" id="template_fila">
		<tr id="fila#idEmpleado">
			<td>#nombreEmpleado</td>
			<td>#apellidoEmpleado</td>
			<td>#fechaNacimientoEmpleado</td>
		</tr>
	</script>

	<script type="text/javascript">
		$("#botonCrear").click(crearEmpleado);

		function crearEmpleado() {
			var promise = $.ajax("/cumplesMeli/empleado.json", {
				method: "POST",
				contentType: 'application/json; charset=utf-8',
				data: JSON.stringify({
					nombre: $("#nombreEmpleado").val(),
					apellido: $("#apellidoEmpleado").val(),
					fechaNacimiento: $("#fechaEmpleado").val()
				})
			})

			promise.done(function (empleado){
				console.log(empleado);
				var fila = $("#template_fila").html();

				fila = fila.replace("#idEmpleado", empleado.id);
				fila = fila.replace("#nombreEmpleado", empleado.nombre);
				fila = fila.replace("#apellidoEmpleado", empleado.apellido);
				fila = fila.replace("#fechaNacimientoEmpleado", empleado.fechaNacimiento.substring(0,10));

				$("#listaEmpleados").append(fila);
				limpiar();
			})

			function limpiar() {
				$("#nombreEmpleado").val("");
				$("#apellidoEmpleado").val("");
				$("#fechaEmpleado").val("");
			}
		};
	</script>
</body>